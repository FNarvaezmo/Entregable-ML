
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CDC Diabetes Health Indicators &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Diabetes" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My sample book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Diabetes
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">CDC Diabetes Health Indicators</a></li>






</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CDC Diabetes Health Indicators</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">CDC Diabetes Health Indicators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos">Base de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estructura">Estructura</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#medidas-y-visualizacion">Medidas y visualización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagrama-de-dispersion">Diagrama de dispersión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion">Matriz de correlación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frecuencia-datos-categoricos">Frecuencia datos categóricos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objetivo">Variable objetivo</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-clasificacion">MODELOS DE CLASIFICACIÓN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesamiento-de-datos">Procesamiento de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-de-entrenamiento-y-evaluacion">Definición de entrenamiento y evaluación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbors-knn">K-Nearest Neighbors (KNN)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-ridge-lasso">Regresión Logistica (Ridge / Lasso)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes">Naive Bayes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBOOST</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support-vector-machine">Support Vector Machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#meta-modelo">Meta modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparar-modelos">Comparar modelos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion">MODELOS DE REGRESIÓN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">K-Nearest Neighbors (KNN)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lineal">REGRESIÓN LINEAL</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge">RIDGE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso">LASSO</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">RANDOM FOREST</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">XGBOOST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support-vector-regression">SUPPORT VECTOR REGRESSION</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#meta-modelo-regresion">Meta Modelo Regresión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion">Comparación</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cdc-diabetes-health-indicators">
<h1>CDC Diabetes Health Indicators<a class="headerlink" href="#cdc-diabetes-health-indicators" title="Link to this heading">#</a></h1>
<p><img alt="" src="day.jpg" /></p>
<p>The Diabetes Health Indicators Dataset contains healthcare statistics and lifestyle survey information about people in general along with their diagnosis of diabetes.</p>
<p><code class="docutils literal notranslate"><span class="pre">Diabetes_binary</span></code> 0 = no diabetes 1 = prediabetes or diabetes</p>
<p><code class="docutils literal notranslate"><span class="pre">HighBP</span></code> 0 = no high BP 1 = high BP</p>
<p><code class="docutils literal notranslate"><span class="pre">HighChol</span></code> 0 = no high cholesterol 1 = high cholesterol</p>
<p><code class="docutils literal notranslate"><span class="pre">CholCheck</span></code> 0 = no cholesterol check in 5 years 1 = yes cholesterol check in 5 years</p>
<p><code class="docutils literal notranslate"><span class="pre">BMI</span></code> Body Mass Index</p>
<p><code class="docutils literal notranslate"><span class="pre">Smoker</span></code> Have you smoked at least 100 cigarettes in your entire life? [Note: 5 packs = 100 cigarettes] 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">Stroke</span></code> (Ever told) you had a stroke. 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">HeartDiseaseorAttack</span></code> coronary heart disease (CHD) or myocardial infarction (MI) 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">PhysActivity</span></code> physical activity in past 30 days - not including job 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">Fruits</span></code> Consume Fruit 1 or more times per day 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">Veggies</span></code> Consume Vegetables 1 or more times per day 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">HvyAlcoholConsump</span></code> Heavy drinkers (adult men having more than 14 drinks per week and adult women having more than 7 drinks per week) 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">AnyHealthcare</span></code> Have any kind of health care coverage, including health insurance, prepaid plans such as HMO, etc. 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">NoDocbcCost</span></code> Was there a time in the past 12 months when you needed to see a doctor but could not because of cost? 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">GenHlth</span></code> Would you say that in general your health is: scale 1-5 1 = excellent 2 = very good 3 = good 4 = fair 5 = poor</p>
<p><code class="docutils literal notranslate"><span class="pre">MentHlth</span></code> 	Now thinking about your mental health, which includes stress, depression, and problems with emotions, for how many days during the past 30 days was your mental health not good? scale 1-30 days</p>
<p><code class="docutils literal notranslate"><span class="pre">PhysHlth</span></code> Now thinking about your physical health, which includes physical illness and injury, for how many days during the past 30 days was your physical health not good? scale 1-30 days</p>
<p><code class="docutils literal notranslate"><span class="pre">DiffWalk</span></code> Do you have serious difficulty walking or climbing stairs? 0 = no 1 = yes</p>
<p><code class="docutils literal notranslate"><span class="pre">Sex</span></code> 0 = female 1 = male</p>
<p><code class="docutils literal notranslate"><span class="pre">Age</span></code> 13-level age category 1=18-24, 2= 25-29”0, 3= 30-34, 4= 35-39, 5= 40-44,
6= 45-49, 7= 50-54, 8= 55-59, 9= 60-64, 10= 65-69,
11= 70-74, 12= 75-79, 13= &gt;80</p>
<p><code class="docutils literal notranslate"><span class="pre">Education</span></code> Education level  scale 1-6 1 = Never attended school or only kindergarten 2 = Grades 1 through 8 (Elementary) 3 = Grades 9 through 11 (Some high school) 4 = Grade 12 or GED (High school graduate) 5 = College 1 year to 3 years (Some college or technical school) 6 = College 4 years or more (College graduate)</p>
<p><code class="docutils literal notranslate"><span class="pre">Income</span></code> Income scale 1-8 1=&lt; <span class="math notranslate nohighlight">\(10.000, 2= \)</span>10.000 - <span class="math notranslate nohighlight">\(15.000, 3=\)</span>15.000 - 20.000, 4=<span class="math notranslate nohighlight">\(20.000 - 25.000,
               5=\)</span>25.000 - 35.000, 6=<span class="math notranslate nohighlight">\(35.000 - 50.000, 7=\)</span>50.000 - <span class="math notranslate nohighlight">\(75.000, 8:=&gt;\)</span>70.000”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<section id="base-de-datos">
<h2>Base de datos<a class="headerlink" href="#base-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;diabetes.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Diabetes_binary</th>
      <th>HighBP</th>
      <th>HighChol</th>
      <th>CholCheck</th>
      <th>BMI</th>
      <th>Smoker</th>
      <th>Stroke</th>
      <th>HeartDiseaseorAttack</th>
      <th>PhysActivity</th>
      <th>Fruits</th>
      <th>...</th>
      <th>AnyHealthcare</th>
      <th>NoDocbcCost</th>
      <th>GenHlth</th>
      <th>MentHlth</th>
      <th>PhysHlth</th>
      <th>DiffWalk</th>
      <th>Sex</th>
      <th>Age</th>
      <th>Education</th>
      <th>Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>40.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>18.0</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>30.0</td>
      <td>30.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>3.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
</section>
<section id="estructura">
<h2>Estructura<a class="headerlink" href="#estructura" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 253680 entries, 0 to 253679
Data columns (total 22 columns):
 #   Column                Non-Null Count   Dtype  
---  ------                --------------   -----  
 0   Diabetes_binary       253680 non-null  float64
 1   HighBP                253680 non-null  float64
 2   HighChol              253680 non-null  float64
 3   CholCheck             253680 non-null  float64
 4   BMI                   253680 non-null  float64
 5   Smoker                253680 non-null  float64
 6   Stroke                253680 non-null  float64
 7   HeartDiseaseorAttack  253680 non-null  float64
 8   PhysActivity          253680 non-null  float64
 9   Fruits                253680 non-null  float64
 10  Veggies               253680 non-null  float64
 11  HvyAlcoholConsump     253680 non-null  float64
 12  AnyHealthcare         253680 non-null  float64
 13  NoDocbcCost           253680 non-null  float64
 14  GenHlth               253680 non-null  float64
 15  MentHlth              253680 non-null  float64
 16  PhysHlth              253680 non-null  float64
 17  DiffWalk              253680 non-null  float64
 18  Sex                   253680 non-null  float64
 19  Age                   253680 non-null  float64
 20  Education             253680 non-null  float64
 21  Income                253680 non-null  float64
dtypes: float64(22)
memory usage: 42.6 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Diabetes_binary         0
HighBP                  0
HighChol                0
CholCheck               0
BMI                     0
Smoker                  0
Stroke                  0
HeartDiseaseorAttack    0
PhysActivity            0
Fruits                  0
Veggies                 0
HvyAlcoholConsump       0
AnyHealthcare           0
NoDocbcCost             0
GenHlth                 0
MentHlth                0
PhysHlth                0
DiffWalk                0
Sex                     0
Age                     0
Education               0
Income                  0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_indices</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0: Diabetes_binary
1: HighBP
2: HighChol
3: CholCheck
4: BMI
5: Smoker
6: Stroke
7: HeartDiseaseorAttack
8: PhysActivity
9: Fruits
10: Veggies
11: HvyAlcoholConsump
12: AnyHealthcare
13: NoDocbcCost
14: GenHlth
15: MentHlth
16: PhysHlth
17: DiffWalk
18: Sex
19: Age
20: Education
21: Income
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>  
<span class="n">col_names</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_indices</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="n">col_names</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_names</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="medidas-y-visualizacion">
<h2>Medidas y visualización<a class="headerlink" href="#medidas-y-visualizacion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar solo las columnas numéricas</span>
<span class="n">df_numeric</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">])</span>

<span class="c1"># Calcular el coeficiente de variación solo en las numéricas</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">df_numeric</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">df_numeric</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">cv</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Coef_Variación&#39;</span>

<span class="c1"># Agregar el coeficiente de variación a las estadísticas descriptivas</span>
<span class="n">desc_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_numeric</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span> <span class="n">cv</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>

<span class="c1"># Redondear y eliminar decimales</span>
<span class="n">desc_stats</span> <span class="o">=</span> <span class="n">desc_stats</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">desc_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                      BMI   MentHlth   PhysHlth
count           253680.00  253680.00  253680.00
mean                28.38       3.18       4.24
std                  6.61       7.41       8.72
min                 12.00       0.00       0.00
25%                 24.00       0.00       0.00
50%                 27.00       0.00       0.00
75%                 31.00       2.00       3.00
max                 98.00      30.00      30.00
Coef_Variación       0.23       2.33       2.06
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Establecer estilo de los gráficos</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>

<span class="c1"># Filtrar solo las columnas numéricas</span>
<span class="n">numeric_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;float64&quot;</span><span class="p">,</span> <span class="s2">&quot;int64&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>  

<span class="c1"># Diccionario con etiquetas personalizadas para cada variable categórica</span>
<span class="n">category_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Diabetes_binary&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Diabetes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Prediabetes/Diabetes&quot;</span><span class="p">},</span>
    <span class="s2">&quot;HighBP&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Normal BP&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;High BP&quot;</span><span class="p">},</span>
    <span class="s2">&quot;HighChol&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Normal Cholesterol&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;High Cholesterol&quot;</span><span class="p">},</span>
    <span class="s2">&quot;CholCheck&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Check&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Checked&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Smoker&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Non-Smoker&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Smoker&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Stroke&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Stroke&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Stroke&quot;</span><span class="p">},</span>
    <span class="s2">&quot;HeartDiseaseorAttack&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Disease&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Disease&quot;</span><span class="p">},</span>
    <span class="s2">&quot;PhysActivity&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Activity&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Active&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Fruits&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Fruits&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Eats Fruits&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Veggies&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Veggies&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Eats Veggies&quot;</span><span class="p">},</span>
    <span class="s2">&quot;HvyAlcoholConsump&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Heavy Drinking&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Heavy Drinker&quot;</span><span class="p">},</span>
    <span class="s2">&quot;AnyHealthcare&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Healthcare&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Has Healthcare&quot;</span><span class="p">},</span>
    <span class="s2">&quot;NoDocbcCost&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Can Afford&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Can&#39;t Afford&quot;</span><span class="p">},</span>
    <span class="s2">&quot;DiffWalk&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;No Difficulty&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Difficulty Walking&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Sex&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Female&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Male&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Age&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;18-24&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;25-29&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;30-34&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;35-39&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;40-44&quot;</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">:</span> <span class="s2">&quot;45-49&quot;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s2">&quot;50-54&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s2">&quot;55-59&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s2">&quot;60-64&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;65-69&quot;</span><span class="p">,</span>
            <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;70-74&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="s2">&quot;75-79&quot;</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="s2">&quot;&gt;80&quot;</span><span class="p">},</span>
    <span class="s2">&quot;Education&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;Never attend School&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s2">&quot;Elementary&quot;</span><span class="p">,</span>
                  <span class="mi">3</span><span class="p">:</span><span class="s2">&quot;Some High School&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s2">&quot;Graduated High School&quot;</span><span class="p">,</span>
                  <span class="mi">5</span><span class="p">:</span><span class="s2">&quot;Attended College or Tech School&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="s2">&quot;Graduate College or Tech School&quot;</span><span class="p">,</span>
                  <span class="p">},</span>
    <span class="s2">&quot;Income&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;&lt; $10.000&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s2">&quot;$10.000 - $15.000&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s2">&quot;$15.000 - 20.000&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s2">&quot;$20.000 - 25.000&quot;</span><span class="p">,</span>
               <span class="mi">5</span><span class="p">:</span><span class="s2">&quot;$25.000 - 35.000&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="s2">&quot;$35.000 - 50.000&quot;</span><span class="p">,</span><span class="mi">7</span><span class="p">:</span><span class="s2">&quot;$50.000 - $75.000&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="s2">&quot;$&gt;70.000&quot;</span><span class="p">},</span>
    <span class="s2">&quot;GenHlth&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;Excellent&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s2">&quot;Very Good&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s2">&quot;Good&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s2">&quot;Fair&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="s2">&quot;Poor&quot;</span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Diccionario con nombres personalizados para algunas variables</span>
<span class="n">custom_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;BMI&quot;</span><span class="p">:</span> <span class="s2">&quot;Índice de Masa Corporal (BMI)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MentHlth&quot;</span><span class="p">:</span> <span class="s2">&quot;Días&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PhysHlth&quot;</span><span class="p">:</span> <span class="s2">&quot;Días&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Crear histogramas para cada variable numérica</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_cols</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blueviolet&quot;</span><span class="p">)</span>
    

    <span class="c1"># Personalizar etiquetas</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribución de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">custom_labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9c86f209e13f629dba1f994ac3829947beeb89ea1bb6722967665bf49da370c9.png" src="_images/9c86f209e13f629dba1f994ac3829947beeb89ea1bb6722967665bf49da370c9.png" />
<img alt="_images/1f0e77157f7382aa743a2f6933d89e8bb568df0faf18744f5a5db877a3cb0be0.png" src="_images/1f0e77157f7382aa743a2f6933d89e8bb568df0faf18744f5a5db877a3cb0be0.png" />
<img alt="_images/82954b1040cd6ad64c59e1b1509de667f37139fd38d7416ce4ed7421bed19354.png" src="_images/82954b1040cd6ad64c59e1b1509de667f37139fd38d7416ce4ed7421bed19354.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;BMI&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set3&quot;</span><span class="p">)</span>

<span class="c1"># Reemplazar etiquetas en el eje X con &quot;Female&quot; y &quot;Male&quot;</span>
<span class="n">sex_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">category_labels</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sex_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">sex_labels</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de BMI según el Sexo&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sexo&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e2b6f59f65b9ae60a74fd61072fe72f498ab35784fbdea885199d0fb864073a8.png" src="_images/e2b6f59f65b9ae60a74fd61072fe72f498ab35784fbdea885199d0fb864073a8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MentHlth&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set3&quot;</span><span class="p">)</span>

<span class="n">sex_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">category_labels</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sex_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">sex_labels</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;How Many Days Was Your Physical Health Not Good?&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sexo&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Días&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9c6b615881f746cb737a470e5086fba9824cb478775ed5aa16fce2cc0e2f2d67.png" src="_images/9c6b615881f746cb737a470e5086fba9824cb478775ed5aa16fce2cc0e2f2d67.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;PhysHlth&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set3&quot;</span><span class="p">)</span>

<span class="n">sex_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">category_labels</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sex_labels</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">sex_labels</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;How Many Days Was Your Mental Health Not Good?&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sexo&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Días&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6d9e27d47b2e0d10fea29769cdf860e1ddb10437be017dd3bcdc04d511482725.png" src="_images/6d9e27d47b2e0d10fea29769cdf860e1ddb10437be017dd3bcdc04d511482725.png" />
</div>
</div>
</section>
<section id="diagrama-de-dispersion">
<h2>Diagrama de dispersión<a class="headerlink" href="#diagrama-de-dispersion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear figura con dos subgráficos</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 1 fila, 2 columnas</span>

<span class="c1"># Gráfico 1: BMI vs. MentHlth</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;MentHlth&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Índice de Masa Corporal (BMI)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Días de Problemas de Salud Mental (MentHlth)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;BMI vs. MentHlth&quot;</span><span class="p">)</span>

<span class="c1"># Gráfico 2: BMI vs. PhysHlth</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;BMI&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;PhysHlth&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Índice de Masa Corporal (BMI)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Días de Problemas de Salud Física (PhysHlth)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;BMI vs. PhysHlth&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d32eb79d9ce2adf8347d6226bb57f7cad8a7bb7aaa06e6dbb24f69fb4df016d.png" src="_images/7d32eb79d9ce2adf8347d6226bb57f7cad8a7bb7aaa06e6dbb24f69fb4df016d.png" />
</div>
</div>
</section>
<section id="matriz-de-correlacion">
<h2>Matriz de correlación<a class="headerlink" href="#matriz-de-correlacion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtrar solo las variables de tipo float</span>
<span class="n">df_floats</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;float&quot;</span><span class="p">])</span>

<span class="c1"># Calcular la matriz de correlación</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_floats</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Crear un heatmap de la matriz de correlación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Personalizar etiquetas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Matriz de Correlación&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/42716633d0b5ebe8ddee395830bfa11c1717816a76573a6bb581a69043adf7fd.png" src="_images/42716633d0b5ebe8ddee395830bfa11c1717816a76573a6bb581a69043adf7fd.png" />
</div>
</div>
</section>
<section id="frecuencia-datos-categoricos">
<h2>Frecuencia datos categóricos<a class="headerlink" href="#frecuencia-datos-categoricos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frecuencia de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frecuencia de Diabetes_binary:

Diabetes_binary
0.0    218334
1.0     35346
Name: count, dtype: int64
----------------------------------------
Frecuencia de HighBP:

HighBP
0.0    144851
1.0    108829
Name: count, dtype: int64
----------------------------------------
Frecuencia de HighChol:

HighChol
0.0    146089
1.0    107591
Name: count, dtype: int64
----------------------------------------
Frecuencia de CholCheck:

CholCheck
1.0    244210
0.0      9470
Name: count, dtype: int64
----------------------------------------
Frecuencia de Smoker:

Smoker
0.0    141257
1.0    112423
Name: count, dtype: int64
----------------------------------------
Frecuencia de Stroke:

Stroke
0.0    243388
1.0     10292
Name: count, dtype: int64
----------------------------------------
Frecuencia de HeartDiseaseorAttack:

HeartDiseaseorAttack
0.0    229787
1.0     23893
Name: count, dtype: int64
----------------------------------------
Frecuencia de PhysActivity:

PhysActivity
1.0    191920
0.0     61760
Name: count, dtype: int64
----------------------------------------
Frecuencia de Fruits:

Fruits
1.0    160898
0.0     92782
Name: count, dtype: int64
----------------------------------------
Frecuencia de Veggies:

Veggies
1.0    205841
0.0     47839
Name: count, dtype: int64
----------------------------------------
Frecuencia de HvyAlcoholConsump:

HvyAlcoholConsump
0.0    239424
1.0     14256
Name: count, dtype: int64
----------------------------------------
Frecuencia de AnyHealthcare:

AnyHealthcare
1.0    241263
0.0     12417
Name: count, dtype: int64
----------------------------------------
Frecuencia de NoDocbcCost:

NoDocbcCost
0.0    232326
1.0     21354
Name: count, dtype: int64
----------------------------------------
Frecuencia de GenHlth:

GenHlth
2.0    89084
3.0    75646
1.0    45299
4.0    31570
5.0    12081
Name: count, dtype: int64
----------------------------------------
Frecuencia de DiffWalk:

DiffWalk
0.0    211005
1.0     42675
Name: count, dtype: int64
----------------------------------------
Frecuencia de Sex:

Sex
0.0    141974
1.0    111706
Name: count, dtype: int64
----------------------------------------
Frecuencia de Age:

Age
9.0     33244
10.0    32194
8.0     30832
7.0     26314
11.0    23533
6.0     19819
13.0    17363
5.0     16157
12.0    15980
4.0     13823
3.0     11123
2.0      7598
1.0      5700
Name: count, dtype: int64
----------------------------------------
Frecuencia de Education:

Education
6.0    107325
5.0     69910
4.0     62750
3.0      9478
2.0      4043
1.0       174
Name: count, dtype: int64
----------------------------------------
Frecuencia de Income:

Income
8.0    90385
7.0    43219
6.0    36470
5.0    25883
4.0    20135
3.0    15994
2.0    11783
1.0     9811
Name: count, dtype: int64
----------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Variables que tendrán etiquetas giradas en el eje X</span>
<span class="n">rotate_labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Income&quot;</span><span class="p">,</span> <span class="s2">&quot;Education&quot;</span><span class="p">}</span>  <span class="c1"># 🔹 Edita esta lista con las variables que deseas rotar</span>

<span class="c1"># Obtener solo las columnas categóricas</span>
<span class="n">categorical_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span> 

<span class="c1"># Definir número de columnas por fila</span>
<span class="n">cols_per_row</span> <span class="o">=</span> <span class="mi">3</span>  
<span class="n">num_vars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical_cols</span><span class="p">)</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_vars</span> <span class="o">/</span> <span class="n">cols_per_row</span><span class="p">)</span>  <span class="c1"># Calcular número de filas necesarias</span>

<span class="c1"># Crear la figura y los ejes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">cols_per_row</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">cols_per_row</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num_rows</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Aplanar la matriz de ejes</span>

<span class="c1"># Generar gráficos</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categorical_cols</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Obtener etiquetas personalizadas si existen</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">category_labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="p">{})</span>

    <span class="c1"># Obtener los valores únicos de la variable</span>
    <span class="n">unique_values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="c1"># Agregar valores encima de las barras</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  
                    <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span>  
                    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># Reemplazar etiquetas en el eje X con nombres personalizados</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">category_labels</span><span class="p">:</span>
        <span class="n">new_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">category_labels</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">unique_values</span><span class="p">]</span>
        <span class="n">rotation_angle</span> <span class="o">=</span> <span class="mi">90</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">rotate_labels</span> <span class="k">else</span> <span class="mi">0</span>  <span class="c1"># Rotar solo si está en la lista</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation_angle</span><span class="p">)</span>

    <span class="c1"># Personalizar etiquetas</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribución de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>

<span class="c1"># Eliminar ejes vacíos si hay menos gráficos que subplots creados</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

<span class="c1"># Ajustar el diseño</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fbff4fdb3dc8eaba82523443f007bc3abc9c8cd4bb41358fd20ccdb7630ed563.png" src="_images/fbff4fdb3dc8eaba82523443f007bc3abc9c8cd4bb41358fd20ccdb7630ed563.png" />
</div>
</div>
</section>
<section id="variable-objetivo">
<h2>Variable objetivo<a class="headerlink" href="#variable-objetivo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Distribución de la variable objetivo</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Diabetes_binary&#39;</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="s1">&#39;orangered&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribución de la Variable Objetivo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Cantidad exacta</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Diabetes_binary&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/03337da773079ae5671983de48ced3e1b6fb208c6e510658f17bf53a6e5b3b60.png" src="_images/03337da773079ae5671983de48ced3e1b6fb208c6e510658f17bf53a6e5b3b60.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Diabetes_binary
0.0    86.066698
1.0    13.933302
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-de-clasificacion">
<h1>MODELOS DE CLASIFICACIÓN<a class="headerlink" href="#modelos-de-clasificacion" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_curve</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
</pre></div>
</div>
</div>
</div>
<section id="procesamiento-de-datos">
<h2>Procesamiento de datos<a class="headerlink" href="#procesamiento-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Diabetes_binary&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Diabetes_binary&#39;</span><span class="p">]</span>

<span class="c1"># Dividir en entrenamiento y prueba </span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Definir columnas</span>
<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">,</span> <span class="s1">&#39;MentHlth&#39;</span><span class="p">,</span> <span class="s1">&#39;PhysHlth&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span>  
<span class="n">binary_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HighBP&#39;</span><span class="p">,</span> <span class="s1">&#39;HighChol&#39;</span><span class="p">,</span><span class="s1">&#39;CholCheck&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoker&#39;</span><span class="p">,</span> <span class="s1">&#39;Stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;HeartDiseaseorAttack&#39;</span><span class="p">,</span> <span class="s1">&#39;PhysActivity&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Fruits&#39;</span><span class="p">,</span> <span class="s1">&#39;Veggies&#39;</span><span class="p">,</span> <span class="s1">&#39;HvyAlcoholConsump&#39;</span><span class="p">,</span> <span class="s1">&#39;AnyHealthcare&#39;</span><span class="p">,</span> <span class="s1">&#39;NoDocbcCost&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;DiffWalk&#39;</span><span class="p">,</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span>
<span class="n">ordinal_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GenHlth&#39;</span><span class="p">,</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span><span class="s1">&#39;Income&#39;</span><span class="p">]</span>

<span class="c1"># Preprocesador: Escalar numéricas, pasar ordinales y binarias</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numeric_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;ord&#39;</span><span class="p">,</span> <span class="s1">&#39;passthrough&#39;</span><span class="p">,</span> <span class="n">ordinal_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="s1">&#39;passthrough&#39;</span><span class="p">,</span> <span class="n">binary_features</span><span class="p">)</span>
    <span class="p">])</span>

<span class="c1"># Aplicar preprocesamiento</span>
<span class="n">X_train_prep</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_prep</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Aplicar SMOTE para balancear clases</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train_smote</span><span class="p">,</span> <span class="n">y_train_smote</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train_prep</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="definicion-de-entrenamiento-y-evaluacion">
<h2>Definición de entrenamiento y evaluación<a class="headerlink" href="#definicion-de-entrenamiento-y-evaluacion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span> <span class="k">as</span> <span class="n">ImbPipeline</span>

<span class="c1"># Función para entrenar y evaluar el modelo con Pipeline, SMOTE y GridSearchCV</span>
<span class="k">def</span><span class="w"> </span><span class="nf">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span><span class="n">modelo_base</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">,</span> <span class="n">etiquetas</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Clase 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Clase 1&#39;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Entrena y evalúa un modelo con Pipeline, SMOTE y GridSearchCV.</span>
<span class="sd">    Devuelve un diccionario con las métricas clave para comparar modelos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Crear pipeline con preprocesador, SMOTE y modelo</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">ImbPipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;smote&#39;</span><span class="p">,</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">&#39;clasificador&#39;</span><span class="p">,</span> <span class="n">modelo_base</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="c1"># Configurar GridSearchCV</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Entrenar modelo</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Predicción con el mejor modelo</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_estimator_</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Calcular las métricas</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Calcular AUC-ROC si es posible</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">y_scores</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Probabilidad para la clase positiva</span>
        <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">auc</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Crear un diccionario con los resultados clave</span>
    <span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="n">tipo_modelo</span><span class="p">(</span><span class="n">modelo_base</span><span class="p">),</span>
        <span class="s1">&#39;Mejores Hiperparámetros&#39;</span><span class="p">:</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de Entrenamiento (s)&#39;</span><span class="p">:</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
        <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
        <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span>
        <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span>
        <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
        <span class="s1">&#39;AUC-ROC&#39;</span><span class="p">:</span> <span class="n">auc</span>
    <span class="p">}</span>

    <span class="c1"># Matriz de confusión</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">tn</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">sensibilidad</span> <span class="o">=</span> <span class="n">tp</span> <span class="o">/</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">fn</span><span class="p">)</span>
    <span class="n">especificidad</span> <span class="o">=</span> <span class="n">tn</span> <span class="o">/</span> <span class="p">(</span><span class="n">tn</span> <span class="o">+</span> <span class="n">fp</span><span class="p">)</span>

    <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Sensibilidad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensibilidad</span>
    <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Especificidad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">especificidad</span>

    <span class="c1"># Mostrar matriz de confusión</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">etiquetas</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">etiquetas</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicción&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Confusión&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Mostrar curva ROC</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_scores</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;AUC = </span><span class="si">{</span><span class="n">auc</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Falsos Positivos&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Tasa de Verdaderos Positivos&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Curva ROC&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Este modelo no permite calcular AUC-ROC ni curva ROC.&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">resultados</span>

<span class="c1"># Función para obtener el tipo de modelo (Nombre)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tipo_modelo</span><span class="p">(</span><span class="n">modelo</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;KNN&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Regresión Logística&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;GaussianNB&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Random Forest&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">SVC</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;SVM&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">XGBClassifier</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;XGBoost&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">StackingClassifier</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Meta-Modelo&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Otro Modelo&quot;</span>

<span class="c1"># Función para comparar los resultados de múltiples modelos</span>
<span class="k">def</span><span class="w"> </span><span class="nf">comparar_modelos</span><span class="p">(</span><span class="n">resultados_modelos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compara múltiples modelos y devuelve un DataFrame con sus métricas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_modelos</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="k-nearest-neighbors-knn">
<h2>K-Nearest Neighbors (KNN)<a class="headerlink" href="#k-nearest-neighbors-knn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el clasificador </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_knn</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>  <span class="c1"># Número de vecinos</span>
    <span class="s1">&#39;clasificador__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span>  <span class="c1"># Tipo de peso</span>
    <span class="s1">&#39;clasificador__p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  <span class="c1"># 1 = Manhattan, 2 = Euclidiana</span>
    <span class="s1">&#39;clasificador__algorithm&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">,</span> <span class="s1">&#39;ball_tree&#39;</span><span class="p">,</span> <span class="s1">&#39;brute&#39;</span><span class="p">]</span>  <span class="c1"># Algoritmo de búsqueda</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_knn</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_knn</span><span class="p">,</span> 
    <span class="n">param_grid_knn</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo KNN:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_knn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ce359be946f5331d15a6ab053359a4bc7279bf6ce9402ae760dff23b0f181414.png" src="_images/ce359be946f5331d15a6ab053359a4bc7279bf6ce9402ae760dff23b0f181414.png" />
<img alt="_images/9f588a3b9378fe5331f20951a685bdb857de3d502bc9bf28f1ce99bcecd182ee.png" src="_images/9f588a3b9378fe5331f20951a685bdb857de3d502bc9bf28f1ce99bcecd182ee.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo KNN:
{&#39;Modelo&#39;: &#39;KNN&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__algorithm&#39;: &#39;kd_tree&#39;, &#39;clasificador__n_neighbors&#39;: 7, &#39;clasificador__p&#39;: 2, &#39;clasificador__weights&#39;: &#39;uniform&#39;}, &#39;Tiempo de Entrenamiento (s)&#39;: 6.84510064125061, &#39;Accuracy&#39;: 0.6752263612850805, &#39;Precision&#39;: 0.2566765891865645, &#39;Recall&#39;: 0.7019833136060509, &#39;F1-Score&#39;: 0.3759053280050706, &#39;AUC-ROC&#39;: 0.7422165083498405, &#39;Sensibilidad&#39;: 0.7019833136060509, &#39;Especificidad&#39;: 0.6708947132281463}
</pre></div>
</div>
</div>
</div>
</section>
<section id="regresion-logistica-ridge-lasso">
<h2>Regresión Logistica (Ridge / Lasso)<a class="headerlink" href="#regresion-logistica-ridge-lasso" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el clasificador </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_logistica</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_logistica</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># Regularización inversa</span>
    <span class="s1">&#39;clasificador__solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="s1">&#39;liblinear&#39;</span><span class="p">],</span>  <span class="c1"># Solvers disponibles</span>
    <span class="s1">&#39;clasificador__penalty&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span><span class="s1">&#39;l2&#39;</span><span class="p">],</span>  <span class="c1"># Regularización L2</span>
    <span class="s1">&#39;clasificador__class_weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># Balancear las clases o no</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_logistica</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_logistica</span><span class="p">,</span> 
    <span class="n">param_grid_logistica</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo de Regresión Logística:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_logistica</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/model_selection/_validation.py:425: FitFailedWarning: 
40 fits failed out of a total of 160.
The score on these train-test partitions for these parameters will be set to nan.
If these failures are not expected, you can try to debug them by setting error_score=&#39;raise&#39;.

Below are more details about the failures:
--------------------------------------------------------------------------------
40 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&quot;, line 732, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/base.py&quot;, line 1151, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File &quot;/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/imblearn/pipeline.py&quot;, line 333, in fit
    self._final_estimator.fit(Xt, yt, **last_step_params[&quot;fit&quot;])
  File &quot;/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/base.py&quot;, line 1151, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File &quot;/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/linear_model/_logistic.py&quot;, line 1168, in fit
    solver = _check_solver(self.solver, self.penalty, self.dual)
  File &quot;/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/linear_model/_logistic.py&quot;, line 56, in _check_solver
    raise ValueError(
ValueError: Solver lbfgs supports only &#39;l2&#39; or &#39;none&#39; penalties, got l1 penalty.

  warnings.warn(some_fits_failed_message, FitFailedWarning)
/opt/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/model_selection/_search.py:976: UserWarning: One or more of the test scores are non-finite: [       nan 0.76239137 0.75256218 0.76382979        nan 0.76239137
 0.75256218 0.76382979        nan 0.73840775 0.73982619 0.74266307
        nan 0.73840775 0.73982619 0.74266307        nan 0.73982619
 0.73983618 0.74125462        nan 0.73982619 0.73983618 0.74125462
        nan 0.73983618 0.73983618 0.73983618        nan 0.73983618
 0.73983618 0.73983618]
  warnings.warn(
</pre></div>
</div>
<img alt="_images/d74be664a629cc269bd8dd3d415a1be8d220c956bd3c514e7a61633f9d2a7f1a.png" src="_images/d74be664a629cc269bd8dd3d415a1be8d220c956bd3c514e7a61633f9d2a7f1a.png" />
<img alt="_images/ee955d5443f83cbdb8cbe1e8703c6035e64bfb26ac911d04003780c375d04517.png" src="_images/ee955d5443f83cbdb8cbe1e8703c6035e64bfb26ac911d04003780c375d04517.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo de Regresión Logística:
{&#39;Modelo&#39;: &#39;Regresión Logística&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__C&#39;: 0.01, &#39;clasificador__class_weight&#39;: &#39;balanced&#39;, &#39;clasificador__penalty&#39;: &#39;l2&#39;, &#39;clasificador__solver&#39;: &#39;liblinear&#39;}, &#39;Tiempo de Entrenamiento (s)&#39;: 2.823896884918213, &#39;Accuracy&#39;: 0.7275137063719043, &#39;Precision&#39;: 0.3069097866284021, &#39;Recall&#39;: 0.7594907474234245, &#39;F1-Score&#39;: 0.4371624653118198, &#39;AUC-ROC&#39;: 0.816153088984727, &#39;Sensibilidad&#39;: 0.7594907474234245, &#39;Especificidad&#39;: 0.7223369849697151}
</pre></div>
</div>
</div>
</div>
</section>
<section id="naive-bayes">
<h2>Naive Bayes<a class="headerlink" href="#naive-bayes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el clasificador </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_gnb</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_gnb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__var_smoothing&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">]</span>  
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_gnb</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_gnb</span><span class="p">,</span> 
    <span class="n">param_grid_gnb</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo GaussianNB:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_gnb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1350af6f9c4dfaf31858eea46f1d46ec3017c0b4f426a7e9b2c359781a5c3e2b.png" src="_images/1350af6f9c4dfaf31858eea46f1d46ec3017c0b4f426a7e9b2c359781a5c3e2b.png" />
<img alt="_images/fc9e7aa87e8d70e38d2bee934192bca2281b9c92202695886008721196fdd9b7.png" src="_images/fc9e7aa87e8d70e38d2bee934192bca2281b9c92202695886008721196fdd9b7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo GaussianNB:
{&#39;Modelo&#39;: &#39;GaussianNB&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__var_smoothing&#39;: 1e-09}, &#39;Tiempo de Entrenamiento (s)&#39;: 0.1466991901397705, &#39;Accuracy&#39;: 0.6880417687353936, &#39;Precision&#39;: 0.27838139304304715, &#39;Recall&#39;: 0.778140246542914, &#39;F1-Score&#39;: 0.4100621467637282, &#39;AUC-ROC&#39;: 0.7807953372515376, &#39;Sensibilidad&#39;: 0.778140246542914, &#39;Especificidad&#39;: 0.6734558438645031}
</pre></div>
</div>
</div>
</div>
</section>
<section id="xgboost">
<h2>XGBOOST<a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el clasificador</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBClassifier</span>


<span class="c1"># Definir el modelo</span>
<span class="n">modelo_xgb</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros</span>
<span class="n">param_grid_xgb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>  
    <span class="s1">&#39;clasificador__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  
    <span class="s1">&#39;clasificador__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>  
    <span class="s1">&#39;clasificador__subsample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>  
    <span class="s1">&#39;clasificador__colsample_bytree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>  
    <span class="s1">&#39;clasificador__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>  
    <span class="s1">&#39;clasificador__reg_lambda&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>  
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_XG</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_xgb</span><span class="p">,</span> 
    <span class="n">param_grid_xgb</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo xgb:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_XG</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ee46ac526cd49b497380ef3af41b1abed68ce8121da8dfb0a5664f3795193672.png" src="_images/ee46ac526cd49b497380ef3af41b1abed68ce8121da8dfb0a5664f3795193672.png" />
<img alt="_images/eb4edcc1a75396cacd9f52fae22cd4229d990f8d4499f94055eb881ae3ef1db2.png" src="_images/eb4edcc1a75396cacd9f52fae22cd4229d990f8d4499f94055eb881ae3ef1db2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo xgb:
{&#39;Modelo&#39;: &#39;XGBoost&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__colsample_bytree&#39;: 0.6, &#39;clasificador__gamma&#39;: 0, &#39;clasificador__learning_rate&#39;: 0.01, &#39;clasificador__max_depth&#39;: 3, &#39;clasificador__n_estimators&#39;: 50, &#39;clasificador__reg_lambda&#39;: 100, &#39;clasificador__subsample&#39;: 0.6}, &#39;Tiempo de Entrenamiento (s)&#39;: 1809.538770198822, &#39;Accuracy&#39;: 0.7684618695370605, &#39;Precision&#39;: 0.3322306307361272, &#39;Recall&#39;: 0.6552440890325933, &#39;F1-Score&#39;: 0.4409067951357862, &#39;AUC-ROC&#39;: 0.807205325209891, &#39;Sensibilidad&#39;: 0.6552440890325933, &#39;Especificidad&#39;: 0.7867905481193449}
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest">
<h2>Random Forest<a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el clasificador </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>  <span class="c1"># Número de árboles</span>
    <span class="s1">&#39;clasificador__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>  <span class="c1"># Profundidad máxima del árbol</span>
    <span class="s1">&#39;clasificador__min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>  <span class="c1"># Mínimo número de muestras para dividir un nodo</span>
    <span class="s1">&#39;clasificador__min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  <span class="c1"># Mínimo número de muestras en una hoja</span>
    <span class="s1">&#39;clasificador__max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">],</span>  <span class="c1"># Estrategia para seleccionar características</span>
    <span class="s1">&#39;clasificador__bootstrap&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>  <span class="c1"># Si usar muestreo con reemplazo</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_rf</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_rf</span><span class="p">,</span> 
    <span class="n">param_grid_rf</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo RandomForest:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_rf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eb7c7d4333bdffc502008e10f1f66cc2437f76e9d74b5d5c85f5bfecc0eace5c.png" src="_images/eb7c7d4333bdffc502008e10f1f66cc2437f76e9d74b5d5c85f5bfecc0eace5c.png" />
<img alt="_images/1b6194f08a0d5413d944ca993815c4c9e99952fb200d9e66d0734f9169d8a777.png" src="_images/1b6194f08a0d5413d944ca993815c4c9e99952fb200d9e66d0734f9169d8a777.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo RandomForest:
{&#39;Modelo&#39;: &#39;Random Forest&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__bootstrap&#39;: True, &#39;clasificador__max_depth&#39;: 10, &#39;clasificador__max_features&#39;: &#39;sqrt&#39;, &#39;clasificador__min_samples_leaf&#39;: 1, &#39;clasificador__min_samples_split&#39;: 2, &#39;clasificador__n_estimators&#39;: 200}, &#39;Tiempo de Entrenamiento (s)&#39;: 77.72843289375305, &#39;Accuracy&#39;: 0.8269155735759652, &#39;Precision&#39;: 0.39683788635078315, &#39;Recall&#39;: 0.4659199168567222, &#39;F1-Score&#39;: 0.4286131619482657, &#39;AUC-ROC&#39;: 0.8115612623794425, &#39;Sensibilidad&#39;: 0.4659199168567222, &#39;Especificidad&#39;: 0.8853566888506692}
</pre></div>
</div>
</div>
</div>
</section>
<section id="support-vector-machine">
<h2>Support Vector Machine<a class="headerlink" href="#support-vector-machine" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el clasificador </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># probability=True para poder calcular ROC AUC</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_svc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># Parámetro de penalización del margen</span>
    <span class="s1">&#39;clasificador__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">],</span>  <span class="c1"># Tipo de kernel</span>
    <span class="s1">&#39;clasificador__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">]</span>  <span class="c1"># Parámetro del kernel (relevante para &#39;rbf&#39;)</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_svc</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_svc</span><span class="p">,</span> 
    <span class="n">param_grid_svc</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo SVC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_svc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f8360efd754b9b8f739fef8553cf3a22a11cf1610a763a12d6ea2c1a0b7e3d6.png" src="_images/1f8360efd754b9b8f739fef8553cf3a22a11cf1610a763a12d6ea2c1a0b7e3d6.png" />
<img alt="_images/42c139a8523d42373a7e660ec2cf4543af7c06c123c3be831a3314885cc84b07.png" src="_images/42c139a8523d42373a7e660ec2cf4543af7c06c123c3be831a3314885cc84b07.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo SVC:
{&#39;Modelo&#39;: &#39;SVM&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__C&#39;: 0.1, &#39;clasificador__gamma&#39;: &#39;scale&#39;, &#39;clasificador__kernel&#39;: &#39;rbf&#39;}, &#39;Tiempo de Entrenamiento (s)&#39;: 155.00673294067383, &#39;Accuracy&#39;: 0.7163836899202356, &#39;Precision&#39;: 0.3009831554184514, &#39;Recall&#39;: 0.7830480094690955, &#39;F1-Score&#39;: 0.43482930817509235, &#39;AUC-ROC&#39;: 0.8187333672114786, &#39;Sensibilidad&#39;: 0.7830480094690955, &#39;Especificidad&#39;: 0.705591490316309}
</pre></div>
</div>
</div>
</div>
</section>
<section id="meta-modelo">
<h2>Meta modelo<a class="headerlink" href="#meta-modelo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar librería</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">StackingClassifier</span>

<span class="c1"># Definir modelos base para el stacking</span>
<span class="n">estimadores_stacking</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;svc&#39;</span><span class="p">,</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;gnb&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<span class="p">]</span>

<span class="c1"># Meta-modelo</span>
<span class="n">final_estimator</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Definir el StackingClassifier</span>
<span class="n">modelo_stacking</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span>
    <span class="n">estimators</span><span class="o">=</span><span class="n">estimadores_stacking</span><span class="p">,</span>
    <span class="n">final_estimator</span><span class="o">=</span><span class="n">final_estimator</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_stacking</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;clasificador__final_estimator__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>  <span class="c1"># Regularización del meta-modelo</span>
    <span class="s1">&#39;clasificador__svc__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>              <span class="c1"># Regularización de SVM</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">resultados_stacking</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline</span><span class="p">(</span>
    <span class="n">modelo_stacking</span><span class="p">,</span> 
    <span class="n">param_grid_stacking</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo StackingClassifier:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_stacking</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/36769023ebbaca2c4912704af39e72350f5162cd101f79dc8594dec88ae389c3.png" src="_images/36769023ebbaca2c4912704af39e72350f5162cd101f79dc8594dec88ae389c3.png" />
<img alt="_images/a40de56e8bebadd265b8be348daa8121089ccd9b5f78579c5fabcb8d7deb59a1.png" src="_images/a40de56e8bebadd265b8be348daa8121089ccd9b5f78579c5fabcb8d7deb59a1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo StackingClassifier:
{&#39;Modelo&#39;: &#39;Meta-Modelo&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;clasificador__final_estimator__C&#39;: 0.01, &#39;clasificador__svc__C&#39;: 0.5}, &#39;Tiempo de Entrenamiento (s)&#39;: 324.7951228618622, &#39;Accuracy&#39;: 0.7215565128898221, &#39;Precision&#39;: 0.30374977301616124, &#39;Recall&#39;: 0.7726550997430641, &#39;F1-Score&#39;: 0.4360697672524052, &#39;AUC-ROC&#39;: 0.8190711344029307, &#39;Sensibilidad&#39;: 0.7726550997430641, &#39;Especificidad&#39;: 0.713284229417483}
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparar-modelos">
<h2>Comparar modelos<a class="headerlink" href="#comparar-modelos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Almacenar los resultados en una lista</span>
<span class="n">resultados_comparacion</span> <span class="o">=</span> <span class="p">[</span><span class="n">resultados_knn</span><span class="p">,</span> <span class="n">resultados_logistica</span><span class="p">,</span> <span class="n">resultados_gnb</span><span class="p">,</span> <span class="n">resultados_rf</span><span class="p">,</span> 
                          <span class="n">resultados_svc</span><span class="p">,</span> <span class="n">resultados_XG</span><span class="p">,</span> <span class="n">resultados_stacking</span><span class="p">]</span>

<span class="c1"># Comparar modelos</span>
<span class="n">df_comparacion</span> <span class="o">=</span> <span class="n">comparar_modelos</span><span class="p">(</span><span class="n">resultados_comparacion</span><span class="p">)</span>

<span class="c1"># Mostrar tabla comparativa</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_comparacion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                Modelo                            Mejores Hiperparámetros  \
0                  KNN  {&#39;clasificador__algorithm&#39;: &#39;kd_tree&#39;, &#39;clasif...   
1  Regresión Logística  {&#39;clasificador__C&#39;: 0.01, &#39;clasificador__class...   
2           GaussianNB             {&#39;clasificador__var_smoothing&#39;: 1e-09}   
3        Random Forest  {&#39;clasificador__bootstrap&#39;: True, &#39;clasificado...   
4                  SVM  {&#39;clasificador__C&#39;: 0.1, &#39;clasificador__gamma&#39;...   
5              XGBoost  {&#39;clasificador__colsample_bytree&#39;: 0.6, &#39;clasi...   
6          Meta-Modelo  {&#39;clasificador__final_estimator__C&#39;: 0.01, &#39;cl...   

   Tiempo de Entrenamiento (s)  Accuracy  Precision    Recall  F1-Score  \
0                     6.845101  0.675226   0.256677  0.701983  0.375905   
1                     2.823897  0.727514   0.306910  0.759491  0.437162   
2                     0.146699  0.688042   0.278381  0.778140  0.410062   
3                    77.728433  0.826916   0.396838  0.465920  0.428613   
4                   155.006733  0.716384   0.300983  0.783048  0.434829   
5                  1809.538770  0.768462   0.332231  0.655244  0.440907   
6                   324.795123  0.721557   0.303750  0.772655  0.436070   

    AUC-ROC  Sensibilidad  Especificidad  
0  0.742217      0.701983       0.670895  
1  0.816153      0.759491       0.722337  
2  0.780795      0.778140       0.673456  
3  0.811561      0.465920       0.885357  
4  0.818733      0.783048       0.705591  
5  0.807205      0.655244       0.786791  
6  0.819071      0.772655       0.713284  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_comparacion</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;background: lightgreen&#39;</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejor_recall</span> <span class="o">=</span> <span class="n">df_comparacion</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_comparacion</span><span class="p">[</span><span class="s1">&#39;Recall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modelo con mejor Recall:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mejor_recall</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo con mejor Recall:
Modelo                                                                       SVM
Mejores Hiperparámetros        {&#39;clasificador__C&#39;: 0.1, &#39;clasificador__gamma&#39;...
Tiempo de Entrenamiento (s)                                           155.006733
Accuracy                                                                0.716384
Precision                                                               0.300983
Recall                                                                  0.783048
F1-Score                                                                0.434829
AUC-ROC                                                                 0.818733
Sensibilidad                                                            0.783048
Especificidad                                                           0.705591
Name: 4, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-de-regresion">
<h1>MODELOS DE REGRESIÓN<a class="headerlink" href="#modelos-de-regresion" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.diagnostic</span><span class="w"> </span><span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;diabetes.csv&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;BMI&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;BMI&#39;</span><span class="p">]</span>  


<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>


<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;MentHlth&#39;</span><span class="p">,</span> <span class="s1">&#39;PhysHlth&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span>  
<span class="n">binary_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HighBP&#39;</span><span class="p">,</span> <span class="s1">&#39;HighChol&#39;</span><span class="p">,</span><span class="s1">&#39;CholCheck&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoker&#39;</span><span class="p">,</span> <span class="s1">&#39;Stroke&#39;</span><span class="p">,</span> <span class="s1">&#39;HeartDiseaseorAttack&#39;</span><span class="p">,</span> <span class="s1">&#39;PhysActivity&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Fruits&#39;</span><span class="p">,</span> <span class="s1">&#39;Veggies&#39;</span><span class="p">,</span> <span class="s1">&#39;HvyAlcoholConsump&#39;</span><span class="p">,</span> <span class="s1">&#39;AnyHealthcare&#39;</span><span class="p">,</span> <span class="s1">&#39;NoDocbcCost&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;DiffWalk&#39;</span><span class="p">,</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span>
<span class="n">ordinal_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GenHlth&#39;</span><span class="p">,</span><span class="s1">&#39;Education&#39;</span><span class="p">,</span><span class="s1">&#39;Income&#39;</span><span class="p">]</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numeric_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;ord&#39;</span><span class="p">,</span> <span class="s1">&#39;passthrough&#39;</span><span class="p">,</span> <span class="n">ordinal_features</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span> <span class="s1">&#39;passthrough&#39;</span><span class="p">,</span> <span class="n">binary_features</span><span class="p">)</span>
    <span class="p">])</span>

<span class="c1"># Aplicar preprocesamiento</span>
<span class="n">X_train_prep</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_prep</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span> <span class="k">as</span> <span class="n">ImbPipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.diagnostic</span><span class="w"> </span><span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Función para entrenar y evaluar el modelo con Pipeline y GridSearchCV</span>
<span class="k">def</span><span class="w"> </span><span class="nf">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span><span class="n">modelo_base</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Entrena y evalúa un modelo con Pipeline y GridSearchCV para regresión.</span>
<span class="sd">    Devuelve un diccionario con las métricas clave para comparar modelos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Crear pipeline con preprocesador y modelo</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">ImbPipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;preprocessor&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;regresor&#39;</span><span class="p">,</span> <span class="n">modelo_base</span><span class="p">)</span>
    <span class="p">])</span>

    <span class="c1"># Configurar GridSearchCV</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Entrenar modelo</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Predicción con el mejor modelo</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_estimator_</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Calcular las métricas</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Calcular ACF de los residuos y p-value de Ljung-Box</span>
    <span class="n">residuos</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span>
    <span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Test Jarque-Bera</span>
    <span class="n">jb_stat</span><span class="p">,</span> <span class="n">jb_pvalue</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuos</span><span class="p">)</span>

    <span class="c1"># Crear un diccionario con los resultados clave</span>
    <span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="n">tipo_modelo</span><span class="p">(</span><span class="n">modelo_base</span><span class="p">),</span>
        <span class="s1">&#39;Mejores Hiperparámetros&#39;</span><span class="p">:</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span>
        <span class="s1">&#39;Tiempo de Entrenamiento (s)&#39;</span><span class="p">:</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljung_box_pvalue</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jb_pvalue</span>
    <span class="p">}</span>

    <span class="c1"># Graficar la relación entre las predicciones y la variable objetivo</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">y_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="p">[</span><span class="n">y_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valor Real&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valor Predicho&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Real vs Predicho&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Graficar el histograma de los residuos</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Residuos&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">resultados</span>

<span class="c1"># Función para obtener el tipo de modelo (Nombre)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tipo_modelo</span><span class="p">(</span><span class="n">modelo</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;KNN&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Regresión Lineal&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Ridge&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Lasso&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;RandomForestRegressor&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">XGBRegressor</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;XGBoost Regressor&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">SVR</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;SVR&quot;</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modelo</span><span class="p">,</span> <span class="n">StackingRegressor</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Stacking&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Otro Modelo&quot;</span>

<span class="c1"># Función para comparar los resultados de múltiples modelos</span>
<span class="k">def</span><span class="w"> </span><span class="nf">Comparar_modelos</span><span class="p">(</span><span class="n">resultados_modelos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compara múltiples modelos y devuelve un DataFrame con sus métricas.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_modelos</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h2>K-Nearest Neighbors (KNN)<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_knn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_knn</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>  <span class="c1"># Número de vecinos</span>
    <span class="s1">&#39;regresor__weights&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span>  <span class="c1"># Tipo de peso</span>
    <span class="s1">&#39;regresor__p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># 1 = Manhattan, 2 = Euclidiana</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar</span>
<span class="n">Resultados_knn</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_knn</span><span class="p">,</span> 
    <span class="n">param_grid_knn</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo KNN:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_knn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a9bd9add0c1ba3de8daef4993aff8061c9b4846be6b7210035677417d7336ea.png" src="_images/8a9bd9add0c1ba3de8daef4993aff8061c9b4846be6b7210035677417d7336ea.png" />
<img alt="_images/3574b0486e1f75ff60758d5e5ddffcba75028f966b3998264960e5cd1a5e7dca.png" src="_images/3574b0486e1f75ff60758d5e5ddffcba75028f966b3998264960e5cd1a5e7dca.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo KNN:
{&#39;Modelo&#39;: &#39;KNN&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__n_neighbors&#39;: 7, &#39;regresor__p&#39;: 1, &#39;regresor__weights&#39;: &#39;uniform&#39;}, &#39;Tiempo de Entrenamiento (s)&#39;: 2.7842087745666504, &#39;RMSE&#39;: 6.516463901796337, &#39;MAPE&#39;: 0.16010498553425878, &#39;R²&#39;: 0.02918624254931379, &#39;Ljung-Box p-value&#39;: 0.3565429172946578, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
<section id="regresion-lineal">
<h2>REGRESIÓN LINEAL<a class="headerlink" href="#regresion-lineal" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el regresor </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">ElasticNet</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_regresion</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_regresion</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__fit_intercept&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>  <span class="c1"># Incluir el término independiente o no</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar el modelo de </span>
<span class="n">Resultados_regresion</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_regresion</span><span class="p">,</span> 
    <span class="n">param_grid_regresion</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo de regresión lineal:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_regresion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cde75fb374590a51f3c3f9ed7dc8ed372cc530646470bfd18a1bbb73fa5ad8a2.png" src="_images/cde75fb374590a51f3c3f9ed7dc8ed372cc530646470bfd18a1bbb73fa5ad8a2.png" />
<img alt="_images/cf78298cb045843e2e6df463bcb3eb468d6b2dcba28daaaeb8ec9174dd8bc53e.png" src="_images/cf78298cb045843e2e6df463bcb3eb468d6b2dcba28daaaeb8ec9174dd8bc53e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo de regresión lineal:
{&#39;Modelo&#39;: &#39;Regresión Lineal&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__fit_intercept&#39;: True}, &#39;Tiempo de Entrenamiento (s)&#39;: 0.18139886856079102, &#39;RMSE&#39;: 6.218062593293787, &#39;MAPE&#39;: 0.15351996767589166, &#39;R²&#39;: 0.11606137085900925, &#39;Ljung-Box p-value&#39;: 0.1479074741807376, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ridge">
<h1>RIDGE<a class="headerlink" href="#ridge" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el regresor </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_ridge</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>  <span class="c1"># Parámetro de regularización</span>
    <span class="s1">&#39;regresor__fit_intercept&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>  <span class="c1"># Incluir el término independiente o no</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">Resultados_ridge</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_ridge</span><span class="p">,</span> 
    <span class="n">param_grid_ridge</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo Ridge:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_ridge</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/565fe96b841a25d94f0c21cb12dcfd27bbe9ccc91aff25f2c0fa99fd61ae169a.png" src="_images/565fe96b841a25d94f0c21cb12dcfd27bbe9ccc91aff25f2c0fa99fd61ae169a.png" />
<img alt="_images/f8eb3e3a8c69b598c92612a7a3c34ddc38c5f5e030a9b8709bea3ae2bee0cf19.png" src="_images/f8eb3e3a8c69b598c92612a7a3c34ddc38c5f5e030a9b8709bea3ae2bee0cf19.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo Ridge:
{&#39;Modelo&#39;: &#39;Ridge&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__alpha&#39;: 10, &#39;regresor__fit_intercept&#39;: True}, &#39;Tiempo de Entrenamiento (s)&#39;: 0.1790001392364502, &#39;RMSE&#39;: 6.217635362462297, &#39;MAPE&#39;: 0.1534888245014101, &#39;R²&#39;: 0.11618283404989815, &#39;Ljung-Box p-value&#39;: 0.14958829768634185, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lasso">
<h1>LASSO<a class="headerlink" href="#lasso" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el regresor Lasso</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lasso</span>

<span class="c1"># Definir el modelo Lasso</span>
<span class="n">modelo_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros para Lasso</span>
<span class="n">param_grid_lasso</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>  <span class="c1"># Parámetro de regularización</span>
    <span class="s1">&#39;regresor__fit_intercept&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>  <span class="c1"># Incluir el término independiente o no</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar el modelo Lasso</span>
<span class="n">Resultados_lasso</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_lasso</span><span class="p">,</span> 
    <span class="n">param_grid_lasso</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados del modelo Lasso</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo Lasso:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_lasso</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ebab6e710fa8a57f0c2fbee22aceba8b4419d7bc0b05f99d23f6a68055f162a1.png" src="_images/ebab6e710fa8a57f0c2fbee22aceba8b4419d7bc0b05f99d23f6a68055f162a1.png" />
<img alt="_images/0c2b97b7b17ff500ce24c4283493ee6e474adb143c91c6de56d8473f027dbd2d.png" src="_images/0c2b97b7b17ff500ce24c4283493ee6e474adb143c91c6de56d8473f027dbd2d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo Lasso:
{&#39;Modelo&#39;: &#39;Lasso&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__alpha&#39;: 0.1, &#39;regresor__fit_intercept&#39;: True}, &#39;Tiempo de Entrenamiento (s)&#39;: 0.21306490898132324, &#39;RMSE&#39;: 6.249366417081727, &#39;MAPE&#39;: 0.15429612107671722, &#39;R²&#39;: 0.10713887759559015, &#39;Ljung-Box p-value&#39;: 0.2651662617308366, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id2">
<h1>RANDOM FOREST<a class="headerlink" href="#id2" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el regresor </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># Definir el modelo</span>
<span class="n">modelo_rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros</span>
<span class="n">param_grid_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>  <span class="c1"># Número de árboles</span>
    <span class="s1">&#39;regresor__max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">],</span>  <span class="c1"># Número de características a considerar para cada división</span>
    <span class="s1">&#39;regresor__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>  <span class="c1"># Profundidad máxima del árbol</span>
    <span class="s1">&#39;regresor__min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># Número mínimo de muestras requeridas para dividir un nodo</span>
    <span class="s1">&#39;regresor__min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>  <span class="c1"># Número mínimo de muestras requeridas en cada hoja</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar el modelo Random Forest</span>
<span class="n">Resultados_rf</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_rf</span><span class="p">,</span> 
    <span class="n">param_grid_rf</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo Random Forest:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_rf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c2ce51d228395132268def6ab9a703f8d5e8475cac51a5b45cd04826541388bb.png" src="_images/c2ce51d228395132268def6ab9a703f8d5e8475cac51a5b45cd04826541388bb.png" />
<img alt="_images/a6099ca15d7dc50e84cbea1718dff96c7abc2323b0e856a55c63187947205433.png" src="_images/a6099ca15d7dc50e84cbea1718dff96c7abc2323b0e856a55c63187947205433.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo Random Forest:
{&#39;Modelo&#39;: &#39;RandomForestRegressor&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__max_depth&#39;: 20, &#39;regresor__max_features&#39;: &#39;sqrt&#39;, &#39;regresor__min_samples_leaf&#39;: 4, &#39;regresor__min_samples_split&#39;: 10, &#39;regresor__n_estimators&#39;: 100}, &#39;Tiempo de Entrenamiento (s)&#39;: 52.873852252960205, &#39;RMSE&#39;: 6.160555539830134, &#39;MAPE&#39;: 0.15110489774027483, &#39;R²&#39;: 0.1323357794740866, &#39;Ljung-Box p-value&#39;: 0.2668605045527275, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id3">
<h1>XGBOOST<a class="headerlink" href="#id3" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el regresor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBRegressor</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_xgb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>  <span class="c1"># Número de árboles</span>
    <span class="s1">&#39;regresor__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>  <span class="c1"># Tasa de aprendizaje</span>
    <span class="s1">&#39;regresor__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>  <span class="c1"># Profundidad máxima de los árboles</span>
    <span class="s1">&#39;regresor__subsample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>  <span class="c1"># Proporción de muestras para entrenar cada árbol</span>
    <span class="s1">&#39;regresor__colsample_bytree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>  <span class="c1"># Proporción de características a considerar por árbol</span>
    <span class="s1">&#39;regresor__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Regularización L1</span>
    <span class="s1">&#39;regresor__lambda&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># Regularización L2</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">Resultados_xgb</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_xgb</span><span class="p">,</span> 
    <span class="n">param_grid_xgb</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados del modelo XGBoost</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo XGBoost:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_xgb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/81f03949a740b45a04e9a91e80a02709b6355a455c4a2d4f376ede17186d4f57.png" src="_images/81f03949a740b45a04e9a91e80a02709b6355a455c4a2d4f376ede17186d4f57.png" />
<img alt="_images/cbfe3fd43b079517a40206b570eeb0312365bd87df7ff734674a18480d45c8cb.png" src="_images/cbfe3fd43b079517a40206b570eeb0312365bd87df7ff734674a18480d45c8cb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo XGBoost:
{&#39;Modelo&#39;: &#39;XGBoost Regressor&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__alpha&#39;: 1, &#39;regresor__colsample_bytree&#39;: 0.8, &#39;regresor__lambda&#39;: 10, &#39;regresor__learning_rate&#39;: 0.2, &#39;regresor__max_depth&#39;: 3, &#39;regresor__n_estimators&#39;: 50, &#39;regresor__subsample&#39;: 0.8}, &#39;Tiempo de Entrenamiento (s)&#39;: 264.1570477485657, &#39;RMSE&#39;: 6.122634335684304, &#39;MAPE&#39;: 0.14976158078254562, &#39;R²&#39;: 0.14298469100977007, &#39;Ljung-Box p-value&#39;: 0.28903236954778394, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
<section id="support-vector-regression">
<h2>SUPPORT VECTOR REGRESSION<a class="headerlink" href="#support-vector-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar el regresor </span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVR</span>

<span class="c1"># Definir el modelo </span>
<span class="n">modelo_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>

<span class="c1"># Definir el espacio de búsqueda de hiperparámetros </span>
<span class="n">param_grid_svr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  <span class="c1"># Parámetro de penalización</span>
    <span class="s1">&#39;regresor__epsilon&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>  <span class="c1"># Tolerancia para el error</span>
    <span class="s1">&#39;regresor__gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">],</span>  <span class="c1"># Coeficiente del kernel RBF</span>
<span class="p">}</span>

<span class="c1"># Entrenar y evaluar </span>
<span class="n">Resultados_svr</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_svr</span><span class="p">,</span> 
    <span class="n">param_grid_svr</span><span class="p">,</span> 
    <span class="n">X_train</span><span class="p">,</span> 
    <span class="n">y_train</span><span class="p">,</span> 
    <span class="n">X_test</span><span class="p">,</span> 
    <span class="n">y_test</span><span class="p">,</span> 
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># Mostrar los resultados </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo SVR:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_svr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5046ef29141a4b0fcd2d71a413f7a0f6dfe026277ce2657b72384217fe1d601c.png" src="_images/5046ef29141a4b0fcd2d71a413f7a0f6dfe026277ce2657b72384217fe1d601c.png" />
<img alt="_images/c9d8c6d8288f378f6ac587908635773b50ba0a350bb781bfe29b3ead9bdac448.png" src="_images/c9d8c6d8288f378f6ac587908635773b50ba0a350bb781bfe29b3ead9bdac448.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo SVR:
{&#39;Modelo&#39;: &#39;SVR&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__C&#39;: 10, &#39;regresor__epsilon&#39;: 0.5, &#39;regresor__gamma&#39;: &#39;scale&#39;}, &#39;Tiempo de Entrenamiento (s)&#39;: 24.495577812194824, &#39;RMSE&#39;: 6.199701221489164, &#39;MAPE&#39;: 0.14372358198716184, &#39;R²&#39;: 0.1212740435341163, &#39;Ljung-Box p-value&#39;: 0.3649409896867029, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
<section id="meta-modelo-regresion">
<h2>Meta Modelo Regresión<a class="headerlink" href="#meta-modelo-regresion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">StackingRegressor</span><span class="p">,</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># 📌 Definir los estimadores base</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;xgb&#39;</span><span class="p">,</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;svr&#39;</span><span class="p">,</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<span class="p">]</span>

<span class="c1"># 📌 Definir el stacking regressor</span>
<span class="n">modelo_stacking</span> <span class="o">=</span> <span class="n">StackingRegressor</span><span class="p">(</span>
    <span class="n">estimators</span><span class="o">=</span><span class="n">estimators</span><span class="p">,</span>
    <span class="n">final_estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># 📌 Definir espacio de búsqueda de hiperparámetros</span>
<span class="n">param_grid_stacking</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;regresor__final_estimator__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span>
    <span class="s1">&#39;regresor__xgb__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;regresor__rf__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="s1">&#39;regresor__rf__n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># 📌 Entrenar y evaluar</span>
<span class="n">Resultados_stacking</span> <span class="o">=</span> <span class="n">entrenar_evaluar_modelo_con_pipeline_regresion</span><span class="p">(</span>
    <span class="n">modelo_stacking</span><span class="p">,</span>
    <span class="n">param_grid_stacking</span><span class="p">,</span>
    <span class="n">X_train</span><span class="p">,</span>
    <span class="n">y_train</span><span class="p">,</span>
    <span class="n">X_test</span><span class="p">,</span>
    <span class="n">y_test</span><span class="p">,</span>
    <span class="n">preprocessor</span>
<span class="p">)</span>

<span class="c1"># 📌 Mostrar resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resultados del modelo Stacking:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Resultados_stacking</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b3106de1e25b7be4de977f7c96f81deffb97c75785318c1cbb9913e79dff5c23.png" src="_images/b3106de1e25b7be4de977f7c96f81deffb97c75785318c1cbb9913e79dff5c23.png" />
<img alt="_images/6ffb311842d88b186a9f99351a1d94b37afb6c8730df087e6cac8da13690103b.png" src="_images/6ffb311842d88b186a9f99351a1d94b37afb6c8730df087e6cac8da13690103b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados del modelo Stacking:
{&#39;Modelo&#39;: &#39;Stacking&#39;, &#39;Mejores Hiperparámetros&#39;: {&#39;regresor__final_estimator__alpha&#39;: 10.0, &#39;regresor__rf__max_depth&#39;: 10, &#39;regresor__rf__n_estimators&#39;: 200, &#39;regresor__xgb__max_depth&#39;: 3}, &#39;Tiempo de Entrenamiento (s)&#39;: 326.64421105384827, &#39;RMSE&#39;: 6.122817891640234, &#39;MAPE&#39;: 0.14947677760906772, &#39;R²&#39;: 0.1429333037755386, &#39;Ljung-Box p-value&#39;: 0.30548665111936485, &#39;Jarque-Bera p-value&#39;: 0.0}
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparacion">
<h2>Comparación<a class="headerlink" href="#comparacion" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Almacenar los resultados en una lista</span>
<span class="n">Resultados_comparacion</span> <span class="o">=</span> <span class="p">[</span><span class="n">Resultados_knn</span><span class="p">,</span> <span class="n">Resultados_regresion</span><span class="p">,</span> <span class="n">Resultados_ridge</span><span class="p">,</span>  <span class="n">Resultados_lasso</span><span class="p">,</span> 
                          <span class="n">Resultados_svr</span><span class="p">,</span> <span class="n">Resultados_xgb</span><span class="p">,</span><span class="n">Resultados_rf</span><span class="p">,</span><span class="n">Resultados_stacking</span><span class="p">]</span>

<span class="c1"># Comparar modelos</span>
<span class="n">Df_comparacion</span> <span class="o">=</span> <span class="n">Comparar_modelos</span><span class="p">(</span><span class="n">Resultados_comparacion</span><span class="p">)</span>

<span class="c1"># Mostrar tabla comparativa</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Df_comparacion</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  Modelo                            Mejores Hiperparámetros  \
0                    KNN  {&#39;regresor__n_neighbors&#39;: 7, &#39;regresor__p&#39;: 1,...   
1       Regresión Lineal                  {&#39;regresor__fit_intercept&#39;: True}   
2                  Ridge  {&#39;regresor__alpha&#39;: 10, &#39;regresor__fit_interce...   
3                  Lasso  {&#39;regresor__alpha&#39;: 0.1, &#39;regresor__fit_interc...   
4                    SVR  {&#39;regresor__C&#39;: 10, &#39;regresor__epsilon&#39;: 0.5, ...   
5      XGBoost Regressor  {&#39;regresor__alpha&#39;: 1, &#39;regresor__colsample_by...   
6  RandomForestRegressor  {&#39;regresor__max_depth&#39;: 20, &#39;regresor__max_fea...   
7               Stacking  {&#39;regresor__final_estimator__alpha&#39;: 10.0, &#39;re...   

   Tiempo de Entrenamiento (s)      RMSE      MAPE        R²  \
0                     2.784209  6.516464  0.160105  0.029186   
1                     0.181399  6.218063  0.153520  0.116061   
2                     0.179000  6.217635  0.153489  0.116183   
3                     0.213065  6.249366  0.154296  0.107139   
4                    24.495578  6.199701  0.143724  0.121274   
5                   264.157048  6.122634  0.149762  0.142985   
6                    52.873852  6.160556  0.151105  0.132336   
7                   326.644211  6.122818  0.149477  0.142933   

   Ljung-Box p-value  Jarque-Bera p-value  
0           0.356543                  0.0  
1           0.147907                  0.0  
2           0.149588                  0.0  
3           0.265166                  0.0  
4           0.364941                  0.0  
5           0.289032                  0.0  
6           0.266861                  0.0  
7           0.305487                  0.0  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejor_RMSE</span> <span class="o">=</span> <span class="n">Df_comparacion</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Df_comparacion</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modelo con mejor RMSE:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mejor_RMSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modelo con mejor RMSE:
Modelo                                                                       KNN
Mejores Hiperparámetros        {&#39;regresor__n_neighbors&#39;: 7, &#39;regresor__p&#39;: 1,...
Tiempo de Entrenamiento (s)                                             2.784209
RMSE                                                                    6.516464
MAPE                                                                    0.160105
R²                                                                      0.029186
Ljung-Box p-value                                                       0.356543
Jarque-Bera p-value                                                          0.0
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diabetes</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">CDC Diabetes Health Indicators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos">Base de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estructura">Estructura</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#medidas-y-visualizacion">Medidas y visualización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagrama-de-dispersion">Diagrama de dispersión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-correlacion">Matriz de correlación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frecuencia-datos-categoricos">Frecuencia datos categóricos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-objetivo">Variable objetivo</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-clasificacion">MODELOS DE CLASIFICACIÓN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesamiento-de-datos">Procesamiento de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-de-entrenamiento-y-evaluacion">Definición de entrenamiento y evaluación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbors-knn">K-Nearest Neighbors (KNN)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-ridge-lasso">Regresión Logistica (Ridge / Lasso)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes">Naive Bayes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBOOST</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support-vector-machine">Support Vector Machine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#meta-modelo">Meta modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparar-modelos">Comparar modelos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-regresion">MODELOS DE REGRESIÓN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">K-Nearest Neighbors (KNN)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lineal">REGRESIÓN LINEAL</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge">RIDGE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso">LASSO</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">RANDOM FOREST</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">XGBOOST</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support-vector-regression">SUPPORT VECTOR REGRESSION</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#meta-modelo-regresion">Meta Modelo Regresión</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion">Comparación</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>